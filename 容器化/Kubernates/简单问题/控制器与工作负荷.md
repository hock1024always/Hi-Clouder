



# 简述Kubernetes RC的机制？

**思路**：

- 明确 RC（ReplicationController）是早期控制器，现已被 ReplicaSet 取代；
- 核心机制：通过 label selector 监控 Pod 数量，维持副本数；
- 强调其“无版本”、“不支持滚动更新”的局限性。

**回答**：

RC（ReplicationController）是 Kubernetes 早期用于**确保指定数量的 Pod 副本始终运行**的控制器。它通过 `label selector` 匹配 Pod，并在 Pod 数量不足时创建新实例，过多时终止多余实例。但 RC **不支持基于标签的复杂选择器（如 matchExpressions）**，且**无法配合 Deployment 实现滚动更新**，因此已被功能更强的 **ReplicaSet** 取代，目前仅用于兼容旧系统，生产环境推荐使用 Deployment。

# 简述Kubernetes deployment升级过程？

**思路**：

以滚动更新（RollingUpdate）为例，说明新旧 ReplicaSet 切换、Pod 逐步替换的过程。

**回答**：

Deployment 升级（默认策略为 RollingUpdate）过程如下：

1. 用户更新 Deployment 的 Pod 模板（如镜像版本）；
2. Deployment 控制器创建一个**新的 ReplicaSet**，并逐步增加其副本数；
3. 同时，**旧 ReplicaSet 的副本数逐步减少**，确保总 Pod 数在 `maxSurge` 和 `maxUnavailable` 范围内；
4. 当新 ReplicaSet 达到期望副本数且旧 ReplicaSet 降为 0 后，升级完成；
5. 若需回滚，Deployment 可快速切换回上一个 ReplicaSet。
   整个过程实现**零停机、平滑发布**。

# 简述Kubernetes deployment升级策略？

**思路**：

列举两种策略（Recreate / RollingUpdate），重点说明 RollingUpdate 的参数控制。

**回答**：

Deployment 支持两种升级策略：

- **Recreate**：先删除所有旧 Pod，再创建新 Pod。会导致服务短暂中断，适用于非高可用场景；
- **RollingUpdate**（默认）：**逐步替换 Pod**，保证服务持续可用。可通过两个参数精细控制：
  - `maxUnavailable`：更新过程中允许不可用的最大 Pod 数（如 25%）；
  - `maxSurge`：允许超出期望副本数的最大额外 Pod 数（如 25%）。
    该策略兼顾稳定性与可用性，是生产环境首选。

# 简述Kubernetes DaemonSet类型的资源特性？

**思路**：

强调“每节点一个 Pod”、常用于系统级守护进程、不受调度器常规逻辑约束。

**回答**：

DaemonSet 确保**集群中每个（或满足条件的）工作节点上恰好运行一个 Pod 副本**。其核心特性包括：

- 自动在新加入节点上创建 Pod，在节点被移除时清理 Pod；
- 常用于部署**节点级守护进程**，如日志采集（Fluentd）、监控代理（Node Exporter）、网络插件（Calico/Weave）；
- Pod 由 DaemonSet 控制器直接绑定到节点，**绕过 kube-scheduler**（除非启用 `ScheduleDaemonSetPods` 特性）；
- 支持更新策略（OnDelete / RollingUpdate），可实现 DaemonSet 的滚动升级。

# 简述Kubernetes自动扩容机制？

**思路**：

分两类：HPA（水平 Pod 扩容）和 VPA（垂直容器资源调整），重点讲 HPA 架构与指标来源。

**回答**：

Kubernetes 主要通过 **Horizontal Pod Autoscaler（HPA）** 实现自动扩容：

- **原理**：HPA 控制器定期从 **Metrics Server**（或自定义/外部指标适配器）获取目标工作负载（如 Deployment）的 CPU、内存或自定义指标（如 QPS）；
- **扩缩容**：当指标超过设定阈值时，HPA 调整工作负载的 `replicas` 数量；
- **要求**：Pod 必须设置 `resources.requests`，且 Metrics Server 已部署；
- **补充机制**：**Vertical Pod Autoscaler（VPA）** 可自动调整容器的 CPU/内存 requests/limits，但需重启 Pod，适用于无法水平扩展的场景。

> 注意：HPA 是云厂商托管服务（如 ACK/TKE）实现弹性伸缩的基础能力。